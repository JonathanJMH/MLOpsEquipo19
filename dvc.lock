schema: '2.0'
stages:
  prepare_data:
    cmd: python refactoring/preprocessing/data_preparation.py --data_path data/processed/data.csv
      --output_dir data/processed --params params.yaml
    deps:
    - path: data/processed/data.csv
      hash: md5
      md5: 72454506ae212a7e4af5730c39c73499
      size: 202927
    - path: params.yaml
      hash: md5
      md5: 4fc9539d9ccd47e8f2e82eec0d25f1c5
      size: 1691
    - path: refactoring/preprocessing/data_preparation.py
      hash: md5
      md5: 472a96930500098c5255f46e2477064f
      size: 8232
    params:
      params.yaml:
        features:
          ordinal:
          - FCVC
          - NCP
          - CH2O
          - FAF
          - TUE
          - CALC
          categorical:
          - Gender
          - family_history_with_overweight
          - FAVC
          - CAEC
          - SMOKE
          - SCC
          - MTRANS
          numerical:
          - Height
          - Weight
          other:
          - Age
          target: NObeyesdad
        split_options:
          test_size: 0.2
          val_size: 0.1
          random_state: 1
        version:
    outs:
    - path: data/processed/X_test.csv
      hash: md5
      md5: d52c6babcfae9b95086c8de9a441d71b
      size: 62722
    - path: data/processed/X_train.csv
      hash: md5
      md5: 092d2db33c9828c14245ccc58a028113
      size: 224694
    - path: data/processed/X_val.csv
      hash: md5
      md5: 135334f1795679250979d460611a51d0
      size: 25183
    - path: data/processed/y_test.csv
      hash: md5
      md5: e91cb9c098499c3c1f7bb837203bfdf3
      size: 7764
    - path: data/processed/y_train.csv
      hash: md5
      md5: 5cdd57ad10cd699fc5d6f589121f56b8
      size: 27629
    - path: data/processed/y_val.csv
      hash: md5
      md5: 65b979250f16a0a64842118dc2a00a10
      size: 3047
  train_model:
    cmd: python refactoring/modeling/train.py --X_train_path data/processed/X_train.csv
      --y_train_path data/processed/y_train.csv --params params.yaml
    deps:
    - path: data/processed/X_train.csv
      hash: md5
      md5: 092d2db33c9828c14245ccc58a028113
      size: 224694
    - path: data/processed/y_test.csv
      hash: md5
      md5: e91cb9c098499c3c1f7bb837203bfdf3
      size: 7764
    - path: params.yaml
      hash: md5
      md5: 4fc9539d9ccd47e8f2e82eec0d25f1c5
      size: 1691
    - path: refactoring/modeling/train.py
      hash: md5
      md5: d6e84e4e8a62d133dd0bd96a2fac491c
      size: 8776
    params:
      params.yaml:
        mlflow:
          experiment_name: Obesity_Level_Model_Analysis
          test_name: Obesity_Level_Model_Testing
          tracking_uri: http://localhost:5000
        models:
          gradient_boosting:
            learning_rate:
            - 0.01
            - 0.1
            - 0.2
            max_depth:
            - 3
            - 5
            - 7
            n_estimators:
            - 100
            - 200
            random_state:
            - 1
          logistic_regression:
            multi_class:
            - multinomial
            solver:
            - lbfgs
            - saga
            max_iter:
            - 1000
            random_state:
            - 1
            C:
            - 0.1
            - 1
            - 10
            - 100
          svm:
            probability:
            - true
            random_state:
            - 1
            C:
            - 0.1
            - 1
            - 10
            kernel:
            - linear
            - rbf
            gamma:
            - 1
            - 0.1
            - 0.01
          random_forest:
            random_state:
            - 1
            n_estimators:
            - 100
            - 200
            - 300
            max_depth:
            - 10
            - 20
            - 30
            - None
            min_samples_split:
            - 2
            - 5
            - 10
            min_samples_leaf:
            - 1
            - 2
            - 4
          k_neighbors:
            n_neighbors:
            - 3
            - 5
            - 7
            - 9
            weights:
            - uniform
            - distance
            p:
            - 1
            - 2
        version:
    outs:
    - path: models/best_model.pkl
      hash: md5
      md5: 82f5691121661964dc3ce70531017a88
      size: 1259688
  test_model:
    cmd: python refactoring/evaluation/evaluate.py --X_test_path data/processed/X_test.csv
      --y_test_path data/processed/y_test.csv --params params.yaml --model_path models/best_model.pkl
    deps:
    - path: data/processed/X_test.csv
      hash: md5
      md5: d52c6babcfae9b95086c8de9a441d71b
      size: 62722
    - path: data/processed/y_test.csv
      hash: md5
      md5: e91cb9c098499c3c1f7bb837203bfdf3
      size: 7764
    - path: models/best_model.pkl
      hash: md5
      md5: 82f5691121661964dc3ce70531017a88
      size: 1259688
    - path: params.yaml
      hash: md5
      md5: 4fc9539d9ccd47e8f2e82eec0d25f1c5
      size: 1691
    - path: refactoring/evaluation/evaluate.py
      hash: md5
      md5: 41fc2b74bd439b846220a42e491c8dfa
      size: 7137
    params:
      params.yaml:
        mlflow:
          experiment_name: Obesity_Level_Model_Analysis
          test_name: Obesity_Level_Model_Testing
          tracking_uri: http://localhost:5000
        version:
    outs:
    - path: data/predictions/predictions.csv
      hash: md5
      md5: 65eae712ac434ef58d820e73885e7d4e
      size: 15102
    - path: metrics/evaluation.json
      hash: md5
      md5: 5f09b2c17f78d86182f1493fd0629314
      size: 93
  load_data:
    cmd: python refactoring/data/load_data.py --data_path data/raw/ObesityDataSet_raw_and_data_sinthetic.csv
      --output_dir data/processed --params params.yaml
    deps:
    - path: data/raw/ObesityDataSet_raw_and_data_sinthetic.csv
      hash: md5
      md5: aff636fcccdf0a24ed7186e48bad2548
      size: 263646
    - path: refactoring/data/load_data.py
      hash: md5
      md5: e6cd558bba18298345c3cb8bcf8e5bd3
      size: 5693
    params:
      params.yaml:
        data_adjusted:
          round_decimals:
            Height: 2
            Weight: 0
            CH2O: 0
          float_to_int:
          - Weight
          - Age
          - FCVC
          - NCP
          - FAF
          - TUE
          - CH2O
          int_to_str:
          - FCVC
          - NCP
          - FAF
          - TUE
          - CH2O
        version:
    outs:
    - path: data/processed/data.csv
      hash: md5
      md5: 72454506ae212a7e4af5730c39c73499
      size: 202927
  test_run:
    cmd: pytest --html=reports/tests/report.html
    outs:
    - path: reports/tests/report.html
      hash: md5
      md5: 5d41daad3a954431ad3741da643763b6
      size: 38165
